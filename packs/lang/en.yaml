# packs/lang/en.yaml
# English base
#
# Keep this file accent-neutral as much as possible. Put UK-specific
# pronunciation tweaks in `en-gb.yaml` and US-specific ones in `en-us.yaml`.

settings:
  # English tends to sound more natural if stressed syllables are not *too* slowed.
  # This also helps teen numbers (e.g. "14") not feel like the ending is clipped.
  primaryStressDiv: 1.4
  secondaryStressDiv: 1.1

  # English sounds clearer with explicit stop closures.
  # Stop closures help clarity, but using them *everywhere* can make the voice feel clicky,
  # especially for short chunks like key echo / character echo.
  # Keep closures mostly after vowels/clusters, and keep the gaps short.
  stopClosureMode: vowel-and-cluster
  stopClosureVowelGapMs: 26
  stopClosureVowelFadeMs: 6
  stopClosureClusterGapMs: 16
  stopClosureClusterFadeMs: 3

  # English: insert short aspiration after unvoiced stops in the right contexts.
  postStopAspirationEnabled: true

  # Keep your existing English long /uː/ shortening behavior (matches your Python logic).
  englishLongUShortenEnabled: true
  englishLongUWordFinalScale: 0.95
  englishLongUKey: "ᵾ"

  # Long vowels (ː) in word-final consonant clusters can sound over-held
  # in a formant synth (e.g. "rules" /ruːlz/, "dialog" /dʌɪəˌlɔːg/).
  # This additional scale shortens length-marked vowels when they are the
  # last vowel in a word and followed by final consonants.
  #
  # Tune per-language if needed.
  lengthenedVowelFinalCodaScale: 0.90


  # Keep length scaling close to the global default.
  # Over-lengthening can make clusters (like "-dcast") sound overly separated.

  spellingDiphthongMode: none
normalization:
  replacements:
    # eSpeak sometimes emits plain 'a' for TRAP. Your Python normalized that to 'æ'.
    - from: "a"
      to: "æ"

    # UK-ish long /uː/ (GOOSE) is typically more fronted than the generic /u/.
    # Our multilingual base 'u' is tuned fairly back; map long uː to a UK-specific key (ᵾ)
    # whose formants are closer to the older en-gb-tuned table.
    - from: "uː"
      to: "ᵾː"

    # Safety: some eSpeak voices omit the length mark in a few environments.
    # If that happens, still use the fronted English GOOSE vowel.
    - from: "u"
      to: "ᵾ"

    # Accent-specific vowel set tweaks live in per-region packs:
    #  - en-gb.yaml (BATH broadening, UK THOUGHT rounding, non-rhotic NURSE)
    #  - en-us.yaml (rhotic NURSE, narrow BATH, etc.)
    # Make /d͡ʒ/ a little less 'soft' by keeping the stop+fricative components explicit.
    - from: "d͡ʒ"
      to:   "dʒ"

    # FOOT vowel: eSpeak uses /ʊ/ in many common words ("book", "good", "could").
    # Our English-tuned variant opens it slightly so it doesn't collapse into GOOSE-like "boo".
    - from: "ʊ"
      to:   "ʊ̞"

    # Pre-fortis clipping: shorten long FLEECE before word-final /t/
    # so minimal pairs like "bead" vs "beat" are distinguishable.
    - from: "iːt"
      to:   "it"
      when:
        atWordEnd: true

    # NEAR vowel (fear, hear, dear): in classic eSpeak en-gb this is often /iə/.
    # In a Klatt-ish formant synth, iə can sound like two full vowel beats.
    # Collapse it to a single vowel with a very short schwa-like tail.
    - from: "iə"
      to:   "iᵊ"
      when:
        atWordEnd: true
    - from: "i͡ə"
      to:   "iᵊ"
      when:
        atWordEnd: true

    # Word-final syllabic /l/ (able, google, poodle, people, etc.)
    # eSpeak usually emits these as schwa+L (ə l) or sometimes syllabic l (l̩).
    #
    # In a formant synth, schwa here can come out too front/central ("ö"-ish) and the /l/ can get lost.
    # Screen-reader voices (including Eloquence) often sound clearer if this ends more like "...-ohl".
    #
    # We do this generically (no word lists) by backing/rounding the nucleus:
    #   əl#  ->  ol#
    #
    # Note: en-us.yaml already slightly fronts "o" -> "ᵒ" for its GOAT vowel quality, so US vs UK stays sensible.
    - from: "əl"
      to:   "ol"
      when:
        atWordEnd: true
    - from: "əɫ"
      to:   "ol"
      when:
        atWordEnd: true
    - from: "@l"
      to:   "ol"
      when:
        atWordEnd: true
    - from: "@ɫ"
      to:   "ol"
      when:
        atWordEnd: true
    - from: "l̩"
      to:   "ol"
      when:
        atWordEnd: true
    - from: "ɫ̩"
      to:   "ol"
      when:
        atWordEnd: true
